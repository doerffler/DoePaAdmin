@inject AuthenticationStateProvider AuthenticationStateProvider

<Sidebar @ref="sidebar"
             ImageSrc="favicon.png"
             Title="ACC Web UI"
             DataProvider="SidebarDataProvider" />


@code {
    Sidebar sidebar = default!;
    IEnumerable<NavItem>? navItems;

    private async Task<SidebarDataProviderResult> SidebarDataProvider(SidebarDataProviderRequest request)
    {
        if (navItems is null)
            navItems = await GetNavItems();

        return await Task.FromResult(request.ApplyTo(navItems));
    }

    private async Task<IEnumerable<NavItem>> GetNavItems()
    {
        var authenticationState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authenticationState.User;

        var navItems = new List<NavItem>();

        if (user.Identity?.IsAuthenticated ?? false)
        {
            navItems.Add(new NavItem { Id = "10", Href = "/dashboard", IconName = IconName.GraphUp, Text = "Dashboard"});
            
            
            navItems.Add(new NavItem { Id = "20", IconName = IconName.Database, Text = "Stammdaten" });
            
            navItems.Add(new NavItem { Id = "21", Href = "/accounting_units", IconName = IconName.FileEarmarkText, Text = "Abrechnungseinheiten", ParentId = "20" });
            navItems.Add(new NavItem { Id = "22", Href = "/orders", IconName = IconName.Briefcase, Text = "Aufträge", ParentId = "20" });
            // navItems.Add(new NavItem { Id = "23", Href = "/bank_accounts", IconName = IconName.CreditCard, Text = "Bankverbindungen", ParentId = "20" });
            navItems.Add(new NavItem { Id = "24", Href = "/debitors", IconName = IconName.Person, Text = "Debitoren", ParentId = "20" });
            // navItems.Add(new NavItem { Id = "25", Href = "/holidays", IconName = IconName.Calendar, Text = "Feiertage", ParentId = "20" });
            navItems.Add(new NavItem { Id = "26", Href = "/business_years", IconName = IconName.Book, Text = "Geschäftsjahre", ParentId = "20" });
            navItems.Add(new NavItem { Id = "27", Href = "/cost_centres", IconName = IconName.Cash, Text = "Kostenstellen", ParentId = "20" });
            navItems.Add(new NavItem { Id = "28", Href = "/creditors", IconName = IconName.Person, Text = "Kreditoren", ParentId = "20" });
            // navItems.Add(new NavItem { Id = "29", Href = "/performance_records", IconName = IconName.ClipboardCheck, Text = "Leistungsnachweise", ParentId = "20" });
            navItems.Add(new NavItem { Id = "30", Href = "/employees", IconName = IconName.People, Text = "Mitarbeiter", ParentId = "20" });
            navItems.Add(new NavItem { Id = "31", Href = "/projects", IconName = IconName.Flag, Text = "Projekte", ParentId = "20" });
            // navItems.Add(new NavItem { Id = "32", Href = "/skills", IconName = IconName.Tools, Text = "Skills", ParentId = "20" });
            navItems.Add(new NavItem { Id = "33", Href = "/activities", IconName = IconName.Pencil, Text = "Tätigkeiten", ParentId = "20" });
            // navItems.Add(new NavItem { Id = "34", Href = "/contracts", IconName = IconName.FileText, Text = "Verträge", ParentId = "20" });
            navItems.Add(new NavItem { Id = "35", Href = "/currencies", IconName = IconName.Coin, Text = "Währungen", ParentId = "20" });
            navItems.Add(new NavItem { Id = "36", Href = "/customers", IconName = IconName.PersonVCard, Text = "Kunden", ParentId = "20" });
            navItems.Add(new NavItem { Id = "37", Href = "/cost_centre_types", IconName = IconName.Briefcase, Text = "Kostenstellenarten", ParentId = "20" });
            navItems.Add(new NavItem { Id = "38", Href = "/postal_codes", IconName = IconName.GeoAlt, Text = "Postleitzahlen", ParentId = "20" });


            navItems.Add(new NavItem { Id = "80", IconName = IconName.Calculator, Text = "Kostenrechnung" });

            navItems.Add(new NavItem { Id = "81", Href = "/incoming_invoices", IconName = IconName.Receipt, Text = "Eingangsrechnungen", ParentId = "80" });
            navItems.Add(new NavItem { Id = "82", Href = "/outgoing_invoices", IconName = IconName.FileEarmarkCheck, Text = "Ausgangsrechnungen", ParentId = "80" });
        }

        return navItems;
    }
}